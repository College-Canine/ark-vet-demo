///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
/////////////// HEY IDIOT /////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////// FINISH THIS WHEN YOU WAKE UP ////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
/////////////// OWNER -> SUPPLIER /////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////
///////////////////// THEN FINISH INVENTORY PAGE //////////////////
///////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////

import { validateRequest } from "@/lib/auth";
import prisma from "@/lib/prisma";

export async function GET() {
  const { user } = await validateRequest();
  if (!user)
    return Response.json({ error: "Not authenticated." }, { status: 400 });

  const suppliers = await prisma.inventorySupplier.findMany({
    where: {},
  });

  return Response.json(suppliers);
}

export async function POST(req: Request) {
  const { user } = await validateRequest();
  if (!user)
    return Response.json({ error: "Not authenticated." }, { status: 400 });

  const data = await req.json();

  const supplier = await prisma.inventorySupplier.create({
    data: {
      slug: data.name.toLowerCase().replace(/\s/g, "-"),
      name: data.name,
      description: data.description,
      email: data.email,
      phone: data.phone,
      website: data.website,
    },
  });

  return Response.json(supplier);
}
